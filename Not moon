-- حماية السكريبت (task.spawn لتجنب الكشف)
task.spawn(function()
    local player = game.Players.LocalPlayer
    local screenGui = Instance.new("ScreenGui", game.CoreGui)
    screenGui.ResetOnSpawn = false

    -- واجهة الدخول START
    local startFrame = Instance.new("Frame", screenGui)
    startFrame.Size = UDim2.new(0, 220, 0, 150)
    startFrame.Position = UDim2.new(0.5, -110, 0.4, -75)
    startFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Instance.new("UICorner", startFrame).CornerRadius = UDim.new(0, 10)
    Instance.new("UIStroke", startFrame).Color = Color3.fromRGB(0, 170, 255)

    local logo = Instance.new("TextLabel", startFrame)
    logo.Size = UDim2.new(1, 0, 0, 50)
    logo.Text = "NX2 v1"
    logo.TextColor3 = Color3.fromRGB(0, 170, 255)
    logo.TextSize = 26
    logo.Font = Enum.Font.SourceSansBold
    logo.BackgroundTransparency = 1

    local startBtn = Instance.new("TextButton", startFrame)
    startBtn.Size = UDim2.new(0.85, 0, 0.35, 0)
    startBtn.Position = UDim2.new(0.075, 0, 0.5, 0)
    startBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    startBtn.Text = "START"
    startBtn.TextColor3 = Color3.new(1, 1, 1)
    startBtn.TextSize = 20
    Instance.new("UICorner", startBtn).CornerRadius = UDim.new(0, 8)

    -- القائمة الرئيسية
    local mainFrame = Instance.new("Frame", screenGui)
    mainFrame.Size = UDim2.new(0, 220, 0, 320)
    mainFrame.Position = UDim2.new(0.5, -110, 0.4, -160)
    mainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    mainFrame.Visible = false
    mainFrame.Active = true
    mainFrame.Draggable = true
    Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 10)
    Instance.new("UIStroke", mainFrame).Color = Color3.fromRGB(0, 170, 255)

    local function createBtn(text, pos, color, parent)
        local btn = Instance.new("TextButton", parent)
        btn.Size = UDim2.new(0.85, 0, 0.12, 0)
        btn.Position = pos
        btn.BackgroundColor3 = color
        btn.Text = text
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.Font = Enum.Font.SourceSansBold
        btn.TextSize = 14
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
        return btn
    end

    local upBtn = createBtn("Safe Zone", UDim2.new(0.075, 0, 0.18, 0), Color3.fromRGB(0, 100, 255), mainFrame)
    local downBtn = createBtn("Gap Down", UDim2.new(0.075, 0, 0.34, 0), Color3.fromRGB(0, 100, 255), mainFrame)
    local takeBtn = createBtn("Instant Take: OFF", UDim2.new(0.075, 0, 0.50, 0), Color3.fromRGB(120, 0, 0), mainFrame)
    local zoomBtn = createBtn("ZOOM: OFF", UDim2.new(0.075, 0, 0.66, 0), Color3.fromRGB(120, 0, 0), mainFrame)
    local discordBtn = createBtn("نسخ سيرفر ديسكورد", UDim2.new(0.075, 0, 0.82, 0), Color3.fromRGB(88, 101, 242), mainFrame)

    startBtn.MouseButton1Click:Connect(function()
        startFrame.Visible = false
        mainFrame.Visible = true
    end)

    -- قائمة الفتحات تحت الأرض من Kenger Hub (كهوف دقيقة - محمية وممددة)
    local underOpenings = {
        CFrame.new(-109.5, -10.5, -32.5),  -- كهف 1 في Island (forward down)
        CFrame.new(109.5, -10.5, -32.5),   -- كهف 2 في Island
        CFrame.new(0, -10.5, -109.5),      -- كهف 3 في Island
        CFrame.new(0, -10.5, 109.5),       -- كهف 4 في Island
    }
    local currentUnderIndex = 1
    local lastPosition = nil  -- للرجوع back

    -- الانتقال إلى الفتحات تحت (forward down - محمي وممدد)
    upBtn.MouseButton1Click:Connect(function()
        task.spawn(function()  -- حماية
            upBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                lastPosition = player.Character.HumanoidRootPart.CFrame  -- حفظ الموقع للرجوع
                local targetCFrame = underOpenings[currentUnderIndex] * CFrame.new(0, 0, -50)  -- forward down (تمديد 50 درجة)
                player.Character.HumanoidRootPart.CFrame = targetCFrame
                currentUnderIndex = currentUnderIndex % #underOpenings + 1
            end
            upBtn.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
        end)
    end)

    -- الرجوع back (ورا)
    downBtn.MouseButton1Click:Connect(function()
        task.spawn(function()  -- حماية
            downBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and lastPosition then
                player.Character.HumanoidRootPart.CFrame = lastPosition  -- رجوع إلى الموقع السابق
            end
            downBtn.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
        end)
    end)

    -- الزوم والأغراض والديسكورد (محمي)
    local it = false
    takeBtn.MouseButton1Click:Connect(function()
        task.spawn(function()
            it = not it
            takeBtn.Text = it and "Instant Take: ON" or "Instant Take: OFF"
            takeBtn.BackgroundColor3 = it and Color3.fromRGB(0, 120, 0) or Color3.fromRGB(120, 0, 0)
        end)
    end)

    game:GetService("RunService").Heartbeat:Connect(function()
        if it then
            for _, v in pairs(workspace:GetDescendants()) do
                if v:IsA("ProximityPrompt") then
                    v.HoldDuration = 0
                end
            end
        end
    end)

    zoomBtn.MouseButton1Click:Connect(function()
        task.spawn(function()
            local active = (zoomBtn.Text == "ZOOM: OFF")
            player.CameraMaxZoomDistance = active and 1000 or 128  -- تمديد الزوم لتجاوز الحماية
            zoomBtn.Text = active and "ZOOM: ON" or "ZOOM: OFF"
            zoomBtn.BackgroundColor3 = active and Color3.fromRGB(0, 120, 0) or Color3.fromRGB(120, 0, 0)
        end)
    end)

    discordBtn.MouseButton1Click:Connect(function()
        task.spawn(function()
            setclipboard("https://discord.gg/syPpUv8Jf")
            discordBtn.Text = "تم النسخ!"
            task.wait(2)
            discordBtn.Text = "نسخ سيرفر ديسكورد"
        end)
    end)
end)